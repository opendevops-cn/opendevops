### FAQ

[[toc]]

### é‚®ç®±è®¾ç½®é—®é¢˜
> ç”±äºå¸¸è§çš„Emailæœ‰å¾ˆå¤šï¼Œè¿™é‡Œåˆ—ä¸¾ä¸‹æœ€å¸¸è§çš„Emailè®¾ç½®
::: details è¯¦ç»†ä¿¡æ¯

- Q: QQé‚®ç®±æ€ä¹ˆè®¾ç½®ï¼Ÿ
- A: QQé‚®ç®±ä¸»è¦æ³¨æ„ä½¿ç”¨ç½‘é¡µç”Ÿæˆæˆæƒç è¿›è¡Œä½œä¸ºå¯†ç ç™»é™†
    - [SMTPåœ°å€](https://service.mail.qq.com/cgi-bin/help?id=28&no=167&subtype=1)ï¼šsmtp.qq.com
    - SMTPç«¯å£ï¼š465
    - SSLåŠ å¯†ï¼šTrue, å¼€å¯
    - ç”¨   æˆ·: <your_qq>@qq.com
    - å¯†   ç ï¼š æˆæƒç ï¼ˆä¸€èˆ¬ä¸º16ä½ï¼‰



- Q: è…¾è®¯ä¼ä¸šé‚®ç®±å¦‚ä½•è®¾ç½®ï¼Ÿ
- A: è…¾è®¯ä¼ä¸šé‚®ç®±åŒQQé‚®ç®±ï¼Œå”¯ä¸€ä¸€ç‚¹SMTPæœåŠ¡å™¨ä¸åŒ
    - [SMTPåœ°å€](https://service.exmail.qq.com/cgi-bin/help?subtype=1&id=28&no=1000585)ï¼šsmtp.exmail.qq.com
    - SMTPç«¯å£ï¼š465
    - SSLåŠ å¯†ï¼šTrue, å¼€å¯
    - ç”¨   æˆ·: <your_name>@domain.com
    - å¯†   ç ï¼š æˆæƒç ï¼ˆä¸€èˆ¬ä¸º16ä½ï¼‰



- Q: ç½‘æ˜“163é‚®ç®±å¦‚ä½•è®¾ç½®ï¼Ÿ
- A: åŒä¸Šï¼Œå”¯ä¸€ä¸€ç‚¹SMTPæœåŠ¡å™¨ä¸åŒ
    - [SMTPåœ°å€](http://help.163.com/09/1223/14/5R7P3QI100753VB8.html)ï¼šsmtp.163.com
    - SMTPç«¯å£ï¼š465
    - SSLåŠ å¯†ï¼šTrue, å¼€å¯
    - ç”¨   æˆ·: <your_name>@163.com
    - å¯†   ç ï¼š æˆæƒç ï¼ˆä¸€èˆ¬ä¸º16ä½ï¼‰



- Q: Gmailé‚®ç®±å¦‚ä½•è®¾ç½®ï¼Ÿ
- A: Gmailé‚®ç®±è€ƒè™‘åˆ°å®‰å…¨ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹2æ­¥
  -  é¦–å…ˆå¼€å¯Google äºŒæ­¥è®¤è¯
  -  [ç”ŸæˆGoogle åº”ç”¨ä¸“ç”¨å¯†ç ](https://support.google.com/mail/answer/185833?hl=zh-Hans)
  - [SMTPåœ°å€](https://support.google.com/mail/answer/7126229?hl=zh-Hans&visit_id=636771670247559816-1235179449&rd=2)ï¼šsmtp.gmail.com
  - SMTPç«¯å£ï¼š465
  - SSLåŠ å¯†ï¼šTrue, å¼€å¯
  - ç”¨   æˆ·: <your_name>@gmail.com
  - å¯†   ç ï¼š æˆæƒç ï¼ˆä¸€èˆ¬ä¸º16ä½ï¼‰
:::



### Docker Bulid æŠ¥é”™é—®é¢˜
::: details è¯¦ç»†ä¿¡æ¯
- å®‰è£…ä¾èµ–æŠ¥é”™ï¼š`Could not install packages due to an EnvironmentError'`

```
é”™è¯¯ä¿¡æ¯ï¼š
Step 10/16 : RUN pip3 install --upgrade pip
---> Running in 83716c526776

Collecting pip
Downloading https://files.pythonhosted.org/packages/c2/d7/90f34cb0d83a6c5631cf71dfe64cc1054598c843a92b400e55675cc2ac37/pip-18.1-py2.py3-none-any.whl (1.3MB)
Installing collected packages: pip
Found existing installation: pip 10.0.1
Uninstalling pip-10.0.1:
Successfully uninstalled pip-10.0.1
Could not install packages due to an EnvironmentError: [Errno 2] No such file or directory: '/tmp/pip-uninstall-y8n2hlf9/usr/local/bin/pip3'

The command '/bin/sh -c pip3 install --upgrade pip' returned a non-zero code: 1
```


- è§£å†³åŠæ³•ï¼š
```shell

Python3xç‰ˆæœ¬åDockeré‡Œé¢éœ€è¦åŠ å…¥--userçš„å‚æ•°ï¼Œä¿®æ”¹Dockerfile, åŠ ä¸Š--userå‚æ•°ï¼Œ å¦‚ï¼špip3 install --user --upgrade pip
```
:::



### å¸¸è§çš„é”™è¯¯ç error codeæ’é”™æ€è·¯

::: details è¯¦ç»†ä¿¡æ¯

- 404ï¼š  ä¸€èˆ¬éƒ½æ˜¯è‡ªå·±ä¿®æ”¹äº†åŸŸåæˆ–è€…é…ç½®é”™è¯¯ï¼Œå¯¼è‡´ç½‘å…³è½¬å‘çš„æ—¶å€™æ²¡åŠæ³•æ‰¾åˆ°
- 500ï¼š  æ¯ä¸ªæ¨¡å—æœåŠ¡çš„åç«¯æŠ¥é”™ï¼Œå…·ä½“å¯å‚çœ‹æŠ¥é”™æ¨¡å—æ—¥å¿—ï¼š /var/log/supervisor/
- 502ï¼š  502é”™è¯¯æ˜¯ç½‘å…³é…ç½®é”™è¯¯ï¼Œè¯·ä»”ç»†æ£€æŸ¥ç½‘å…³é…ç½®å’ŒDNSé…ç½®ï¼Œç¡®ä¿åŸŸåæ­£å¸¸è§£æï¼Œä¸”èƒ½è®¿é—®ã€‚
:::

### Google Authenticatoræ€ä¹ˆä½¿ç”¨?
> å®‰å…¨ä¸€å®šæ˜¯æœ€é‡è¦çš„ï¼Œç›¸ä¿¡å¾ˆå¤šäººéƒ½çŸ¥é“è°·æ­Œèº«ä»½éªŒè¯å™¨ï¼Œè¿™é‡Œç®€å•è¯´ä¸‹Googleèº«ä»½éªŒè¯å™¨æ€ä¹ˆä½¿ç”¨, æœ¬å¹³å°GoogleéªŒè¯ç å¯†é’¥æ˜¯å‘é€åˆ°ç”¨æˆ·é‚®ç®±çš„ã€‚
::: details è¯¦ç»†ä¿¡æ¯
**ä¸‹è½½è°·æ­ŒéªŒè¯å™¨**
- iOSç”¨æˆ·ç™»å½•AppStoreæœç´¢"Authenticator"
- å®‰å“ç”¨æˆ·ç™»å½•åº”ç”¨å•†åº—æˆ–åˆ©ç”¨æ‰‹æœºæµè§ˆå™¨æœç´¢â€œè°·æ­ŒéªŒè¯å™¨â€ä¸‹è½½,ä¹Ÿå¯[ç‚¹å‡»ä¸‹è½½](https://www.wandoujia.com/apps/com.google.android.apps.authenticator2)

**æ·»åŠ æ‰€éœ€ç½‘ç«™éªŒè¯ç **

`PS ç”±äºå›½å†…Androidå¤šæ•°éƒ½è¢«é˜‰å‰²äº†Googleæ¡†æ¶ï¼Œä¸èƒ½æ‰«ç çš„è¾“å…¥æ‰‹åŠ¨è´´å…¥å¯†é’¥`

- æ‰«ææ¡å½¢ç   

![](/google_auth01.jpg)

- æ‰‹åŠ¨è¾“å…¥å¯†é’¥  

![](/google_auth02.jpg)


**æ‰‹æœºä¸¢å¤±æ€ä¹ˆåŠ**

1. ä½ å¯ä»¥æœç´¢ä½ ä¹‹å‰çš„é‚®ä»¶è®°å½•ï¼Œæˆ–è€…è‡ªè¡Œè®°å½•ä¿å­˜ä¸‹æ¥
2. å¯¹äºCODOè¶…çº§ç®¡ç†å‘˜å¯ä»¥ç™»é™†æ•°æ®åº“è‡ªè¡ŒæŸ¥çœ‹ï¼ŒSQLè¯­æ³•ï¼š`select google_key from codo_admin.mg_users where username='codo_test';`

:::

### Loginç•Œé¢/ç™»é™†åä¸€ç›´è‡ªåŠ¨åˆ·æ–°/é—ªå±/é€€å‡ºï¼Ÿ

::: details è¯¦ç»†ä¿¡æ¯
Qï¼šå¯ä»¥ç™»é™†è¿›å»ï¼Œä½†æ˜¯ä¸€ç›´é—ªå±åˆ·æ–°/é€€å‡ºï¼Ÿ
  
Aï¼šå‡ºç°è¿™ä¸ªé—®é¢˜æ˜¯å› ä¸ºç½‘å…³`token_secret`å’Œ`codo-admin`é‡Œé¢`token_secret`é…ç½®ä¸ä¸€æ ·ï¼Œæ”¹æˆä¸€æ ·å³å¯ã€‚
è¯·ä»”ç»†é˜…è¯»ç½‘å…³é…ç½®ä¸­çš„æ³¨å†ŒAPIç½‘å…³æ–‡ä»¶ `configs.lua`è¿™å—
:::
  
###  Dockerå†…éƒ¨çš„MySQLã€Redisæ— æ³•è¿æ¥é—®é¢˜  

> æœ‰äº›åŒå­¦å‘ç°åœ¨Dockerå†…éƒ¨æ— æ³•è¿æ¥åˆ°å¤–é¢çš„MySQLï¼Œå¦‚ä¸‹æŠ¥é”™ï¼Œä¸€èˆ¬éƒ½æ˜¯é˜²ç«å¢™å¼•èµ·çš„ï¼Œé˜²ç«å¢™ä¸èƒ½å…³é—­ï¼Œå› ä¸ºNATåœ¨ç”¨ï¼Œæ¸…ç©ºæ‰Filteré“¾ `iptables -F`æˆ–è€…æ·»åŠ ä¸Š3306ç«¯å£å°è¯•ä¸‹ã€‚  
::: details è¯¦ç»†ä¿¡æ¯
![](/243fb74c5a73af046696423d6ce7b92.png)

:::

### ç½‘å…³æç¤ºåŸŸågw.opendevops.cnæ‰¾ä¸åˆ°ï¼Œæˆ–è€…ç½‘ç»œä¸é€š
```
iptables -F
### è¿™ä¸ªæ˜¯ç¯å¢ƒå‡†å¤‡æ—¶å€™éƒ¨ç½²çš„dnsmasqæ‰€åœ¨çš„åœ°å€ï¼Œè¯·çå¤§çœ¼ç›ä¸è¦å†™é”™äº†
echo "nameserver 127.0.0.1" > /etc/resolv.conf   
service dnsmasq restart
systemctl restart docker.service
ntpdate ntp1.aliyun.com
```
### æ–°éƒ¨ç½²çš„ç³»ç»Ÿæ— æ³•åˆ›å»ºUserï¼Ÿæ²¡åŠæ³•çœ‹åˆ°åˆ›å»º/é‡ç½®/è·å–Tokenï¼Ÿ  

::: details è¯¦ç»†ä¿¡æ¯
Qï¼šæ–°éƒ¨ç½²çš„æ—¶å€™ç™»é™†è¿›å»ï¼Œç‚¹å‡»ç”¨æˆ·åˆ—è¡¨æ²¡åŠæ³•åˆ›å»º/çœ‹ä¸åˆ°é‡ç½®å¯†ç /é‡ç½®MFAæŒ‰é’®ç­‰é—®é¢˜ï¼Ÿ 

Aï¼šè¿™ä¸ªé—®é¢˜æ˜¯å› ä¸ºæ²¡æœ‰åˆ›å»ºè§’è‰²ï¼Œé»˜è®¤éƒ¨ç½²çš„æ—¶å€™æƒé™/ç»„ä»¶æ•°æ®éƒ½æ˜¯åˆå§‹åŒ–è¿›å»çš„ï¼Œä½†æ˜¯è§’è‰²éœ€è¦ç”¨æˆ·è‡ªå·±åˆ›å»ºï¼Œç”¨æˆ·å¯ä»¥ç‚¹å‡»**ç”¨æˆ·ç®¡ç†**-->**è§’è‰²ç®¡ç†**  æ–°å»ºä¸€ä¸ªè§’è‰²ï¼Œç»™æ‰€æœ‰ç»„ä»¶/èœå•/æƒé™  ç„¶åé€€å‡ºï¼Œå¼ºåˆ·ä¸‹æµè§ˆå™¨å°±å¯ä»¥äº†  

æ“ä½œæ­¥éª¤å¯å‚è€ƒï¼šhttps://docs.opendevops.cn/zh/guide/more/permission/

:::

### å¦‚ä½•åœ¨ CODO ä¸Šå¼€å‘æ–°åº”ç”¨

> åŸºäºCODOçš„å¼€å‘æ¡†æ¶è¿›è¡Œå¼€å‘æ–°åº”ç”¨ï¼Œå‰ç«¯ã€åç«¯æ€ä¹ˆå¼€å‘å’Œæ³¨å†Œ
::: details è¯¦ç»†ä¿¡æ¯

Qï¼šå‰ç«¯æ€ä¹ˆå¼€å‘æ¥å…¥ï¼Ÿ

1. CODO ä½¿ç”¨ qiankun å¾®å‰ç«¯æ¶æ„è¿›è¡Œæ¨¡å—é›†æˆã€‚
2. ä½¿ç”¨CODOå®˜æ–¹æ¨¡æ¿ï¼š[codo-subapp-tpl å‰ç«¯æ¨¡æ¿]((https://github.com/opendevops-cn/codo-subapp-tpl))
3. å¼€å‘å®Œæˆåï¼Œå°†å­åº”ç”¨æ³¨å†Œåˆ° CODO ä¸»æ¡†æ¶ä¸­ï¼Œå…³äºæ³¨å†Œå’Œé€šä¿¡æ–¹å¼ï¼Œè¯¦è§ï¼š[å¾®å‰ç«¯å¼€å‘æ–‡æ¡£]((https://github.com/opendevops-cn/codo-subapp-tpl)) 
   
Qï¼šåç«¯æ€ä¹ˆå¼€å‘æ¥å…¥ï¼Ÿ

1. åç«¯æœåŠ¡åº”æä¾›æ ‡å‡† RESTful æ¥å£ï¼Œå¹¶é€šè¿‡ å¤©é—¨ç½‘å…³ æ¥å…¥ CODOã€‚
2. ä½¿ç”¨ä»»æ„åç«¯æ¡†æ¶ï¼ˆå¦‚ SpringBoot / Node.js / Flaskï¼‰
3. æ¥å£è·¯å¾„è§„èŒƒåŒ–ï¼Œå¹¶é…ç½®åˆ°å¤©é—¨ç½‘å…³ä¸­
4. é…ç½®å‚è€ƒæ–‡æ¡£ [å¤©é—¨æ–‡æ¡£](https://github.com/opendevops-cn/codo-gateway)

Qï¼šåº”ç”¨å±•ç¤ºä¸æ³¨å†Œï¼Ÿ
> å°†ä½ çš„åº”ç”¨æ³¨å†Œåˆ° CODO ç®¡ç†åå°å³å¯åœ¨ä¸»ç•Œé¢å±•ç¤ºã€‚

1. ç™»å½• CODO ç®¡ç†åå°
2. è¿›å…¥ åº”ç”¨ç®¡ç† é¡µé¢ï¼Œæ·»åŠ ä½ çš„åº”ç”¨ä¿¡æ¯
3. å…·ä½“é…ç½®å­—æ®µè¯¦è§ï¼š [ç”¨æˆ·æ‰‹å†Œ]((https://github.com/opendevops-cn/codo-admin/blob/main/docs/codo-admin.md))ã€‚

**ğŸ“š å…¶ä»–å‚è€ƒèµ„æ–™** 

- ğŸ”§ [qiankun å¾®å‰ç«¯æ¡†æ¶](https://github.com/umijs/qiankun)

::: 

### Docker compose çš„éƒ¨ç½²å¦‚ä½•æ›´æ–°æœ€æ–°ç‰ˆæœ¬
::: details è¯¦ç»†ä¿¡æ¯

1. æ›´æ–°é•œåƒå¹¶é‡å¯

```bash
docker compose -f docker-compose-app.yaml pull
docker compose -f docker-compose-app.yaml up -d
```

2. æ›´æ–°åæŠ¥500é”™è¯¯ï¼Œä¸€èˆ¬æ˜¯å­—æ®µå‘ç”Ÿå˜æ›´éœ€è¦åˆ è¡¨é‡å»ºæˆ–è€…è‡ªå·±è¡¥é½å­—æ®µ 

:::